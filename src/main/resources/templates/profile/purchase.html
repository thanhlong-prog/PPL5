<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopee - ƒê∆°n mua</title>

    <link rel="icon" th:href="@{/assets/images/R.png}" type="image/x-icon">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/assets/css/purchase.css">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/header.css">
    <link rel="stylesheet" href="/assets/css/footer.css">
    <link rel="stylesheet" href="/assets/css/popup.css">
    <link rel="stylesheet" href="/assets/css/card.css">
    <link rel="stylesheet" th:href="@{/assets/css/toastmsg.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body>
    <div class="header">
        <div th:insert="~{header :: header}"></div>
    </div>
    <div class="main-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="user-brief">
                <img th:src="${user.avatar}" alt="Avatar">
                <div>
                    <div class="user-name" th:text="${user.name}"></div>
                    <div class="edit-profile">
                        <span>S·ª≠a h·ªì s∆°</span>
                    </div>
                </div>
            </div>
            <ul class="sidebar-menu">
                <!-- <li><a href="#">T√†i kho·∫£n c·ªßa t√¥i</a></li> -->
                <li><a href="/buyer/profile">H·ªì s∆°</a></li>
                <!-- <li><a href="#">Ng√¢n h√†ng</a></li>
                <li><a href="#">Th·∫ª t√≠n d·ª•ng/Ghi n·ª£</a></li> -->
                <li><a href="/buyer/profile/address">ƒê·ªãa ch·ªâ</a></li>
                <li><a href="/buyer/profile/password">ƒê·ªïi m·∫≠t kh·∫©u</a></li>
                <li><a href="/buyer/profile/shopee">Thi·∫øt l·∫≠p Shop</a></li>
                <li class="active"><a href="/buyer/profile/purchase">ƒê∆°n mua</a></li>
                <li><a href="/buyer/profile/order">Th√¥ng b√°o</a></li>
                <li><a href="/buyer/profile/voucher">Kho voucher</a></li>
                <li><a href="/buyer/profile/shopee">Shopee Xu</a></li>
                <!-- <li><a href="#">Shopee Live</a></li>
                <li><a href="#">ShopeePay</a></li>
                <li><a href="#">ƒê√°nh gi√° c·ªßa t√¥i</a></li>
                <li><a href="#">L·ªãch s·ª≠ Shopee Reward</a></li>
                <li><a href="#">Qu·∫£n l√Ω ƒë∆°n n·∫°p th·∫ª</a></li>
                <li><a href="#">Thi·∫øt l·∫≠p t√†i kho·∫£n</a></li>  -->
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="purchase-container">
                <div class="purchase-tabs">
                    <div class="tab-item" th:classappend="${mode} == 'all' ? ' active' : ''">
                        <a href="/buyer/profile/purchase?mode=all">T·∫•t c·∫£</a>
                    </div>
                    <div class="tab-item" th:classappend="${mode} == 'pending' ? ' active' : ''">
                        <a href="/buyer/profile/purchase?mode=pending">Ch·ªù x√°c nh·∫≠n</a>
                    </div>
                    <div class="tab-item" th:classappend="${mode} == 'waiting' ? ' active' : ''">
                        <a href="/buyer/profile/purchase?mode=waiting">Ch·ªù l·∫•y h√†ng</a>
                    </div>
                    <div class="tab-item" th:classappend="${mode} == 'shipping' ? ' active' : ''">
                        <a href="/buyer/profile/purchase?mode=shipping">ƒêang giao</a>
                    </div>
                    <div class="tab-item" th:classappend="${mode} == 'completed' ? ' active' : ''">
                        <a href="/buyer/profile/purchase?mode=completed">ƒê√£ giao</a>
                    </div>
                    <div class="tab-item" th:classappend="${mode} == 'cancelled' ? ' active' : ''">
                        <a href="/buyer/profile/purchase?mode=cancelled">ƒê√£ h·ªßy</a>
                    </div>

                </div>
                <!-- <div class="search-box">
                    <div class="search-input">
                        <input type="text" placeholder="T√¨m ki·∫øm theo T√™n Shop, ID ƒë∆°n h√†ng ho·∫∑c T√™n S·∫£n ph·∫©m">
                        <i>üîç</i>
                    </div>
                    <div class="date-filter">
                        <select>
                            <option>3 th√°ng g·∫ßn ƒë√¢y</option>
                            <option>6 th√°ng g·∫ßn ƒë√¢y</option>
                            <option>T·∫•t c·∫£</option>
                        </select>
                    </div>
                </div> -->
                <div class="order-list">
                    <div class="order-list" th:each="entry : ${groupedCartList}">
                        <div class="order-card">
                            <div class="order-header">
                                <div class="order-shop">
                                    <i>üè™</i>
                                    <span th:text="${entry.key.name}">Shop ƒêi·ªán T·ª≠ ABC</span>
                                </div>
                                <!-- <div class="order-status">
                                    <i>‚è±Ô∏è</i>
                                    <span>Ch·ªù x√°c nh·∫≠n</span>
                                </div> -->
                            </div>
                            <div th:each="cart : ${entry.value}" class="order-product">
                                <div class="order-product">
                                    <img th:src="${cart.product.thumbnail}" alt="Product" class="product-image">
                                    <div class="product-info">
                                        <div class="product-name" th:text="${cart.product.title}">Tai nghe Bluetooth
                                            kh√¥ng d√¢y TWS F9 Pro v·ªõi Micro, Tai
                                            nghe th·ªÉ thao ch·ªëng n∆∞·ªõc cao c·∫•p</div>

                                        <div th:if="${cart.productVatiants != null}" class="product-variation">
                                            <span th:each="optionValue : ${cart.productVatiants.optionValues}">
                                                <span
                                                    th:text="${optionValue.option.name + ': ' + optionValue.value}"></span><br>
                                            </span>
                                        </div>

                                        <div class="product-quantity" th:text="'x'+${cart.orderQuantity}">x1</div>
                                    </div>
                                    <div class="product-price" th:text="'‚Ç´'+${cart.totalPrice}">‚Ç´199.000</div>
                                </div>
                            </div>

                            <div class="order-footer">
                                <div class="order-total">
                                    <div class="order-total-text">Th√†nh ti·ªÅn:</div>
                                    <div class="order-total-amount">‚Ç´199.000</div>
                                </div>
                                <div class="order-actions">
                                    <button class="btn-contact">Li√™n h·ªá ng∆∞·ªùi b√°n</button>
                                    <button th:if="${mode == 'pending'}" class="btn-review" th:onclick="'cancelCart(' + ${entry.key.id} + ')'">H·ªßy ƒë∆°n h√†ng</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <div class="footer">
        <div th:insert="~{footer :: footer}"></div>
    </div>
</body>

</html>
<script src="/assets/js/header.js"></script>
<script src="/assets/js/popup1.js"></script>
<script th:src="@{/assets/js/toastmsg.js}"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    
    function cancelCart(sellerId) {
        console.log(sellerId);
        $.ajax({
            type: "POST",
            url: "/buyer/profile/purchase/cancel",
            data: {
                sellerId: sellerId
            },
            success: function (response) {
                console.log("thanh cong");
            },
            error: function () {
                console.error("L·ªói khi h·ªßy ƒë∆°n h√†ng");
            }
        });
    }
</script>